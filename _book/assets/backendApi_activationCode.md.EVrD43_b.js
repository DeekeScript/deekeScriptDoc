import{_ as a,c as n,o as i,ag as p}from"./chunks/framework.S-Qvb3wi.js";const d=JSON.parse('{"title":"后端接口","description":"DeekeScript - 后端接口","frontmatter":{"title":"后端接口","description":"DeekeScript - 后端接口"},"headers":[],"relativePath":"backendApi/activationCode.md","filePath":"backendApi/activationCode.md"}'),e={name:"backendApi/activationCode.md"};function l(t,s,r,c,h,o){return i(),n("div",null,s[0]||(s[0]=[p(`<h1 id="后端接口" tabindex="-1">后端接口 <a class="header-anchor" href="#后端接口" aria-label="Permalink to &quot;后端接口&quot;">​</a></h1><blockquote><p>激活码逻辑已经内嵌在DeekeScript中，开发者只需实现对应后端接口即可</p></blockquote><h2 id="接口验证" tabindex="-1">接口验证 <a class="header-anchor" href="#接口验证" aria-label="Permalink to &quot;接口验证&quot;">​</a></h2><blockquote><p>为了保证接口的安全性，DeekeScript客户端请求接口时，会携带以下字段：</p></blockquote><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>$android_id = $_POST[&#39;android_id&#39;];</span></span>
<span class="line"><span>$secret = $_POST[&#39;secret&#39;];</span></span>
<span class="line"><span>$timestamp = $_POST[&#39;timestamp&#39;];</span></span>
<span class="line"><span>$token = $_POST[&#39;token&#39;];//仅激活的时候会携带，其他接口不会携带token</span></span>
<span class="line"><span></span></span>
<span class="line"><span>//后端拿到参数后，需要做下面的验证</span></span>
<span class="line"><span>//下面的token激活码是根据android_id在后端数据库中查询的</span></span>
<span class="line"><span>if ($secret !== md5($android_id . $res-&gt;getAttr(&quot;token&quot;) . $timestamp)) {</span></span>
<span class="line"><span>    return [&#39;code&#39; =&gt; 1, &#39;msg&#39; =&gt; &#39;激活码已失效&#39;];//激活失效了</span></span>
<span class="line"><span>}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h2 id="激活" tabindex="-1">激活 <a class="header-anchor" href="#激活" aria-label="Permalink to &quot;激活&quot;">​</a></h2><blockquote><p>type: bind</p></blockquote><p>需要在DeekeScript.json配置文件中配置Uri请求地址。如果用户不填写激活码，则运行DeekeScript上的业务功能（开发者开发的功能）时会提示输入激活码</p><p>DeekeScript请求：</p><div class="language-json vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Request Method: POST</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Content-Type: application/json</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">请求地址：/dke/login</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">请求参数：</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;token&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;djhcn8dhfjwie7dbs9ikqlchdn76shbc&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;android_id&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;sdfsd-dsfdsa-fdasfdas&quot;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> //用户卸载App或者恢复出厂设置后，此ID将会变化</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>你的接口需要返回如下json内容：</p><div class="language-json vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">//激活成功</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">code</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">msg</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;成功&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">success</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: { </span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">token_time</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;29.99天后过期&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">//激活失败</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">code</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">success</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">msg</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;激活失败&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h2 id="激活状态检查" tabindex="-1">激活状态检查 <a class="header-anchor" href="#激活状态检查" aria-label="Permalink to &quot;激活状态检查&quot;">​</a></h2><blockquote><p>type: checkBind</p></blockquote><p>需要在DeekeScript.json配置文件中配置Uri请求地址，DeekeScript每次运行业务功能（开发者开发的功能）都会请求一次此接口，如果返回失败，则会提示用户对应的信息</p><p>DeekeScript请求：</p><div class="language-json vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Request Method: POST</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Content-Type: application/json</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">请求地址：/dke/checkBind</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">请求参数：</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;timestamp&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1793293729</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;secret&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;djhcn8dhfjwie7dbs9ikqlchdn76shbc&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;android_id&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;sdfsd-dsfdsa-fdasfdas&quot;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> //用户卸载App或者恢复出厂设置后，此ID将会变化</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>你的接口需要返回如下json内容：</p><div class="language-json vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">//成功</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">code</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">msg</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;成功&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">success</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">token_time</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;29.98天后过期&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: []}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">//失败</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">code</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">msg</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;已过期&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">success</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: []}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h2 id="下面的接口请求参数同激活状态检查" tabindex="-1">下面的接口请求参数同“激活状态检查” <a class="header-anchor" href="#下面的接口请求参数同激活状态检查" aria-label="Permalink to &quot;下面的接口请求参数同“激活状态检查”&quot;">​</a></h2><h3 id="百度ai大模型token获取接口" tabindex="-1">百度AI大模型token获取接口 <a class="header-anchor" href="#百度ai大模型token获取接口" aria-label="Permalink to &quot;百度AI大模型token获取接口&quot;">​</a></h3><blockquote><p>type: aiSpeechToken</p><p>每次生成智能话术都会调用一次此接口，接口地址：/dke/getBaiduToken</p></blockquote><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>//成功返回如下</span></span>
<span class="line"><span>{code: 0, msg: &quot;成功&quot;,success: true, access_token: &quot;xxxxxxxxxxxxxx&quot;, data: []}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>//失败返回，可以通过此接口限制调用次数</span></span>
<span class="line"><span>{code: 1, msg: &quot;智能话术已使用完~&quot;,success: false, data: []}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="配置接口" tabindex="-1">配置接口 <a class="header-anchor" href="#配置接口" aria-label="Permalink to &quot;配置接口&quot;">​</a></h3><blockquote><p>type: config</p><p>请求地址：/dkee/config</p></blockquote><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>{</span></span>
<span class="line"><span>    &quot;code&quot;: 0, </span></span>
<span class="line"><span>    &quot;msg&quot;: &quot;成功&quot;, </span></span>
<span class="line"><span>    &quot;success&quot;: true,</span></span>
<span class="line"><span>    &quot;data&quot;: {</span></span>
<span class="line"><span>        &quot;ad&quot;: {</span></span>
<span class="line"><span>            &quot;app_open_url&quot; : &#39;开屏广告图片地址，如：https://xx.xx.xx/1.png&#39;, </span></span>
<span class="line"><span>            &quot;app_pay_ad_url&quot; : &#39;支付宝支付入口广告图片地址，如：https://xx.xx.xx/2.png&#39;</span></span>
<span class="line"><span>        },</span></span>
<span class="line"><span>        &quot;payList&quot;:{</span></span>
<span class="line"><span>            &quot;switch&quot; =&gt; true,//是否开启扫码支付</span></span>
<span class="line"><span>            &quot;money&quot; =&gt; [499, 199, 39.9, 299, 99, 599, 9.9],//设置为0，则自动隐藏，如只展示【9.9元/天】试用：[0, 0, 0, 0, 0, 0, 9.9]</span></span>
<span class="line"><span>            &quot;day&quot; =&gt; [&#39;1年&#39;, &#39;1月&#39;, &#39;3天&#39;, &#39;3月&#39;, &#39;7天&#39;, &#39;2年&#39;, &#39;1天&#39;]</span><span> //money和day一一对应</span></span>
<span class="line"><span>        },</span></span>
<span class="line"><span>        &quot;role&quot;: [</span></span>
<span class="line"><span>            &quot;label&quot; : &quot;角色名称，如：营销大师&quot;,</span></span>
<span class="line"><span>            &quot;value&quot; : 1,</span></span>
<span class="line"><span>            &quot;content&quot; : &quot;智能体角色属性设定：你的角色是一个营销大师，xxxxxx&quot;,</span></span>
<span class="line"><span>        ]</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span>}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><p><code>注意：这里的的role、ad等属性与deekeScript.json配置的dataFrom有联系，如果开发者需要使用类似角色的动态select选择框表单，可以使用此接口实现。</code></p><h2 id="app升级接口" tabindex="-1">APP升级接口 <a class="header-anchor" href="#app升级接口" aria-label="Permalink to &quot;APP升级接口&quot;">​</a></h2><p>目前DeekeScript内置了软件升级能力，可以通过设置<a href="./../config/config.html#settinglists参数">settinglists参数</a>，type为updateApp的时候，用户点击“系统升级”，会请求配置的url参数地址完成APP下载与安装</p><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>//升级配置如下：</span></span>
<span class="line"><span>&quot;settingLists&quot;: [</span></span>
<span class="line"><span>    {</span></span>
<span class="line"><span>        &quot;title&quot;: &quot;系统升级&quot;,</span></span>
<span class="line"><span>        &quot;icon&quot;: &quot;img/update.png&quot;,</span></span>
<span class="line"><span>        &quot;type&quot;: &quot;updateApp&quot;,</span></span>
<span class="line"><span>        &quot;url&quot;: &quot;/dke/updateApp&quot;</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span>]</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>点击“系统升级”后，系统会请求“<a href="https://xxx.xx/dke/updateApp?version=100%E2%80%9D%EF%BC%88%E6%B3%A8%E6%84%8F%E6%98%AFpost%E6%96%B9%E5%BC%8F%E8%AF%B7%E6%B1%82%EF%BC%89%EF%BC%8C%E6%8E%A5%E5%8F%A3%E8%BF%94%E5%9B%9E%E5%A6%82%E4%B8%8Bjson%E5%86%85%E5%AE%B9%E5%A6%82%E4%B8%8B%EF%BC%9A" target="_blank" rel="noreferrer">https://xxx.xx/dke/updateApp?version=100”（注意是post方式请求），接口返回如下json内容如下：</a></p><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>//存在更新</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>    code: 0, </span></span>
<span class="line"><span>    msg: &quot;成功&quot;, </span></span>
<span class="line"><span>    success: true, data: {</span></span>
<span class="line"><span>        &quot;downloadUrl&quot;: &quot;https:\\/\\/xxx.xxx.com\\/xxx.apk&quot;,</span></span>
<span class="line"><span>        &quot;newVersion&quot;: &quot;101&quot;,</span></span>
<span class="line"><span>        &quot;appCurrentVersion&quot;: &quot;100&quot;</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>//不存在最新版</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>    code: 1,</span></span>
<span class="line"><span>    msg: &quot;暂无更新&quot;,</span></span>
<span class="line"><span>    data: []</span></span>
<span class="line"><span>}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><blockquote><p>downloadUrl：下载地址 newVersion：新版本号 appCurrentVersion：当前版本号</p></blockquote><p>系统拿到接口结果后，会比对当前版本号是否小于最新版本号，如果是则访问downloadUrl下载apk，最终提示用户安装apk，并完成升级。</p><h2 id="支付成功接口成功后app端将不会展示支付入口" tabindex="-1">支付成功接口【成功后，App端将不会展示支付入口】 <a class="header-anchor" href="#支付成功接口成功后app端将不会展示支付入口" aria-label="Permalink to &quot;支付成功接口【成功后，App端将不会展示支付入口】&quot;">​</a></h2><blockquote><p>type: getToken</p><p>接口地址：/alipay/getToken</p></blockquote><p>本接口，在用户支付完成后，会返回激活码和剩余天数（开发者需要自行实现本接口）。用户在App内支付后，App会调用本接口判断支付是否成功。同时这个接口返回激活码后，支付入口将会关闭。</p><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>  //返回成功，则不允许调用支付；  用户支付成功后，本接口应该返回下面的数据</span></span>
<span class="line"><span>  {code: 0, msg: &#39;不展示支付入口&#39;, success: true, data: [], &quot;token&quot;: &quot;激活码&quot;, &quot;token_time&quot;: &quot;还剩1天过期&quot;}</span></span>
<span class="line"><span>  //返回失败，可以支付</span></span>
<span class="line"><span>  {code: 1, msg: &#39;展示支付入口&#39;, success: false, data: []}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h2 id="支付宝支付订单创建接口" tabindex="-1">支付宝支付订单创建接口 <a class="header-anchor" href="#支付宝支付订单创建接口" aria-label="Permalink to &quot;支付宝支付订单创建接口&quot;">​</a></h2><blockquote><p>type: createOrder</p><p>接口地址：/alipay/createOrder</p></blockquote><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>//请求参数如下：</span></span>
<span class="line"><span>//扫码支付</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>    &quot;type&quot;: &quot;scan&quot;,</span></span>
<span class="line"><span>    &quot;goods_name&quot;: &quot;一天&quot;,</span></span>
<span class="line"><span>    &quot;total_amount&quot;: &quot;9.9&quot;</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>//App支付</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>    &quot;goods_name&quot;: &quot;一天&quot;,</span></span>
<span class="line"><span>    &quot;total_amount&quot;: &quot;9.9&quot;</span></span>
<span class="line"><span>}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><blockquote><p>注意：这里的goods_name是来自<a href="#配置接口">配置接口</a>里面的payList参数里面的day字段，total_amount来自payList参数里面的money字段</p></blockquote><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>//返回数据如下：</span></span>
<span class="line"><span>//成功</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>    code: 0, </span></span>
<span class="line"><span>    msg: &#39;成功&#39;, </span></span>
<span class="line"><span>    success: true, </span></span>
<span class="line"><span>    data: {</span></span>
<span class="line"><span>        params: &#39;订单信息，字符串形式；支付宝返回的AlipayTradeAppPayResponse-&gt;body内容&#39;,</span></span>
<span class="line"><span>        order_no: &#39;xccxxvxxccxcx&#39;,</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span>//失败</span></span>
<span class="line"><span>{code: 1, msg: &#39;支付失败&#39;, success: false, data: []}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div>`,43)]))}const u=a(e,[["render",l]]);export{d as __pageData,u as default};
